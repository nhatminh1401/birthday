<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>ChÃºc má»«ng sinh nháº­t BÃ© Bá»±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: radial-gradient(ellipse at center, #2d0036 0%, #000 100%);
      height: 100%;
      width: 100vw;
      touch-action: none;
    }
    body {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    canvas {
      display: block;
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 1;
    }
    .hint {
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      color: #fff;
      font-family: 'Arial', sans-serif;
      font-size: 1.1rem;
      background: rgba(0,0,0,0.4);
      padding: 7px 18px;
      border-radius: 18px;
      z-index: 2;
      user-select: none;
      pointer-events: none;
    }
    @media (max-width: 600px) {
      .hint { font-size: 1rem; padding: 6px 12px; }
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <!-- <div class="hint">Cháº¡m vÃ o mÃ n hÃ¬nh Ä‘á»ƒ táº¡o hiá»‡u á»©ng má»›i ğŸ‰</div> -->
  <audio id="bg-music" src="audio.mp3" autoplay loop></audio>
  <button id="music-toggle" style="position:fixed;top:16px;right:16px;z-index:1000;background:rgba(0,0,0,0.5);color:#fff;border:none;border-radius:50%;width:44px;height:44px;font-size:1.5rem;cursor:pointer;">ğŸ”Š</button>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();

    const messages = [
      "ğŸ’– Happy Birthday báº¡n iu ğŸ’–",
      "âœ¨ ChÃºc báº¡n tuá»•i má»›i ráº¡ng rá»¡ âœ¨",
      "ğŸ‚ Má»™t Ä‘á»i an nhiÃªn, háº¡nh phÃºc ğŸ‚",
      "ğŸŒ¸ YÃªu thÆ°Æ¡ng ngáº­p trÃ n ğŸŒ¸",
      "ğŸ’« LuÃ´n tá»a sÃ¡ng nhÃ© ğŸ’«",
      "ğŸ‰ ChÃºc báº¡n luÃ´n vui váº», thÃ nh cÃ´ng ğŸ‰",
      "ğŸŒˆ Má»—i ngÃ y Ä‘á»u lÃ  má»™t niá»m vui má»›i ğŸŒˆ",
      "ğŸ€ Gáº·p nhiá»u may máº¯n, bÃ¬nh an ğŸ€",
      "ğŸ¥° LuÃ´n Ä‘Æ°á»£c yÃªu thÆ°Æ¡ng vÃ  che chá»Ÿ ğŸ¥°",
      "ğŸŒŸ ChÃºc má»i Æ°á»›c mÆ¡ cá»§a báº¡n thÃ nh hiá»‡n thá»±c ğŸŒŸ",
      "ğŸ Nháº­n Ä‘Æ°á»£c tháº­t nhiá»u quÃ  vÃ  lá»i chÃºc ğŸ",
      "ğŸ’ ChÃºc báº¡n luÃ´n xinh Ä‘áº¹p, ráº¡ng rá»¡ ğŸ’",
      "ğŸ¦‹ Má»™t tuá»•i má»›i tháº­t nhiá»u tráº£i nghiá»‡m tuyá»‡t vá»i ğŸ¦‹",
      "â˜€ï¸ NgÃ y má»›i, tuá»•i má»›i, niá»m vui má»›i â˜€ï¸",
    ];

    const directions = ["up", "down", "left", "right"];
    const colors = [
      "#ff6ec7", "#ffd700", "#7cf9ff", "#ffb347", "#baffc9", "#f7a8b8"
    ];

    function randomBetween(a, b) {
      return a + Math.random() * (b - a);
    }

    function getFontSize(z) {
      if (window.innerWidth < 600) {
        return 24 + z * 36;
      } else {
        return 18 + z * 32;
      }
    }

    let particles = Array.from({ length: 12 }, (_, i) => {
      const direction = directions[Math.floor(Math.random() * directions.length)];
      const z = Math.random();
      const color = colors[Math.floor(Math.random() * colors.length)];
      const delay = Math.random() * 1000;
      return {
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        z,
        scale: 0.5 + z * 1.5,
        text: messages[i % messages.length],
        speed: 0.3 + z * 1.1,
        fontSize: getFontSize(z),
        alpha: 0,
        maxAlpha: 0.5 + z * 0.5,
        color,
        direction,
        t: Math.random() * Math.PI * 2,
        delay,
        born: performance.now() + delay,
        fadeIn: true
      };
    });

    // Thay vÃ¬ 1 áº£nh, dÃ¹ng máº£ng nhiá»u áº£nh
    const imageSources = [
      'image.jpg',
      'image1.jpg',
      'image2.jpg',
      // ThÃªm tÃªn file áº£nh khÃ¡c náº¿u muá»‘n
    ];
    const loadedImages = [];
    let imagesLoaded = 0;
    for (let src of imageSources) {
      const img = new Image();
      img.src = src;
      img.onload = () => { imagesLoaded++; };
      loadedImages.push(img);
    }

    // particles cho áº£nh, má»—i particle chá»n ngáº«u nhiÃªn 1 áº£nh
    let imageParticles = Array.from({ length: 6 }, () => {
      const direction = directions[Math.floor(Math.random() * directions.length)];
      const z = Math.random();
      const delay = Math.random() * 1000;
      const imgIndex = Math.floor(Math.random() * loadedImages.length);
      return {
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        z,
        scale: 0.5 + z * 1.5,
        speed: 0.3 + z * 1.1,
        size: 60 + z * 80,
        alpha: 0,
        maxAlpha: 0.5 + z * 0.5,
        direction,
        t: Math.random() * Math.PI * 2,
        delay,
        born: performance.now() + delay,
        fadeIn: true,
        imgIndex
      };
    });

    function draw3DText(p, time) {
      ctx.save();
      ctx.globalAlpha = p.alpha;
      ctx.fillStyle = p.color;
      ctx.shadowColor = p.color;
      ctx.shadowBlur = 0;
      ctx.font = `bold ${p.fontSize}px 'Pacifico', 'Arial', cursive`;
      const waveY = Math.sin(time / 1200 + p.t + p.x / 200) * 2 * p.scale;
      ctx.fillText(p.text, p.x, p.y + waveY);
      ctx.restore();
    }

    // HÃ m váº½ áº£nh Ä‘á»™ng cho nhiá»u áº£nh
    function drawImageParticle(p, time) {
      const img = loadedImages[p.imgIndex];
      if (!img || !img.complete) return;
      ctx.save();
      ctx.globalAlpha = p.alpha;
      const scale = p.scale * (1 + 0.2 * Math.sin(time / 800 + p.t));
      const size = p.size * scale;
      ctx.drawImage(
        img,
        p.x - size / 2,
        p.y - size / 2,
        size,
        size
      );
      ctx.restore();
    }

    function animate(time) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Váº½ particles áº£nh
      for (let p of imageParticles) {
        if (performance.now() > p.born) {
          if (p.fadeIn && p.alpha < p.maxAlpha) {
            p.alpha += 0.01 + p.z * 0.02;
            if (p.alpha > p.maxAlpha) p.alpha = p.maxAlpha;
          }
        } else {
          p.alpha = 0;
        }
        drawImageParticle(p, time);
        let speed = p.speed * (0.7 + 0.3 * Math.sin(time / 1000 + p.t));
        switch (p.direction) {
          case "up":
            p.y -= speed;
            if (p.y < -60) {
              p.y = canvas.height + 60;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "down":
            p.y += speed;
            if (p.y > canvas.height + 60) {
              p.y = -60;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "left":
            p.x -= speed;
            if (p.x < -120) {
              p.x = canvas.width + 120;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "right":
            p.x += speed;
            if (p.x > canvas.width + 120) {
              p.x = -120;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
        }
        p.t += 0.008 + p.z * 0.01;
      }
      for (let p of particles) {
        if (performance.now() > p.born) {
          if (p.fadeIn && p.alpha < p.maxAlpha) {
            p.alpha += 0.01 + p.z * 0.02;
            if (p.alpha > p.maxAlpha) p.alpha = p.maxAlpha;
          }
        } else {
          p.alpha = 0;
        }
        draw3DText(p, time);
        let speed = p.speed * (0.7 + 0.3 * Math.sin(time / 1000 + p.t));
        switch (p.direction) {
          case "up":
            p.y -= speed;
            if (p.y < -60) {
              p.y = canvas.height + 60;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "down":
            p.y += speed;
            if (p.y > canvas.height + 60) {
              p.y = -60;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "left":
            p.x -= speed;
            if (p.x < -350) {
              p.x = canvas.width + 120;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
          case "right":
            p.x += speed;
            if (p.x > canvas.width + 350) {
              p.x = -120;
              p.alpha = 0;
              p.born = performance.now() + p.delay;
              p.fadeIn = true;
            }
            break;
        }
        p.t += 0.008 + p.z * 0.01;
      }
      requestAnimationFrame(animate);
    }

    animate(performance.now());

    window.addEventListener("resize", () => {
      resizeCanvas();
      // Cáº­p nháº­t láº¡i fontSize cho particles khi Ä‘á»•i kÃ­ch thÆ°á»›c
      for (let p of particles) {
        p.fontSize = getFontSize(p.z);
      }
    });

    // Táº¡o hiá»‡u á»©ng má»›i khi cháº¡m hoáº·c click
    function spawnParticles(x, y) {
      for (let i = 0; i < 3; i++) {
        const direction = directions[Math.floor(Math.random() * directions.length)];
        const z = Math.random();
        const color = colors[Math.floor(Math.random() * colors.length)];
        const delay = Math.random() * 500;
        particles.push({
          x: x + randomBetween(-30, 30),
          y: y + randomBetween(-30, 30),
          z,
          scale: 0.5 + z * 1.5,
          text: messages[Math.floor(Math.random() * messages.length)],
          speed: 0.3 + z * 1.1,
          fontSize: getFontSize(z),
          alpha: 0,
          maxAlpha: 0.5 + z * 0.5,
          color,
          direction,
          t: Math.random() * Math.PI * 2,
          delay,
          born: performance.now() + delay,
          fadeIn: true
        });
      }
      // Giá»›i háº¡n tá»•ng sá»‘ particles Ä‘á»ƒ khÃ´ng bá»‹ lag
      if (particles.length > 16) particles = particles.slice(-16);
    }

    // Khi click/touch, thÃªm particle áº£nh má»›i vá»›i áº£nh ngáº«u nhiÃªn
    function spawnImageParticles(x, y) {
      for (let i = 0; i < 1; i++) {
        const direction = directions[Math.floor(Math.random() * directions.length)];
        const z = Math.random();
        const delay = Math.random() * 500;
        const imgIndex = Math.floor(Math.random() * loadedImages.length);
        imageParticles.push({
          x: x + randomBetween(-30, 30),
          y: y + randomBetween(-30, 30),
          z,
          scale: 0.5 + z * 1.5,
          speed: 0.3 + z * 1.1,
          size: 60 + z * 80,
          alpha: 0,
          maxAlpha: 0.5 + z * 0.5,
          direction,
          t: Math.random() * Math.PI * 2,
          delay,
          born: performance.now() + delay,
          fadeIn: true,
          imgIndex
        });
      }
      if (imageParticles.length > 12) imageParticles = imageParticles.slice(-12);
    }

    canvas.addEventListener('touchstart', function(e) {
      const touch = e.touches[0];
      spawnParticles(touch.clientX, touch.clientY);
      spawnImageParticles(touch.clientX, touch.clientY);
    });
    canvas.addEventListener('mousedown', function(e) {
      spawnParticles(e.clientX, e.clientY);
      spawnImageParticles(e.clientX, e.clientY);
    });

    // Xá»­ lÃ½ nÃºt báº­t/táº¯t nháº¡c
    const music = document.getElementById('bg-music');
    const btn = document.getElementById('music-toggle');
    let playing = true;
    btn.onclick = function() {
      if (playing) {
        music.pause();
        btn.textContent = 'ğŸ”‡';
      } else {
        music.play();
        btn.textContent = 'ğŸ”Š';
      }
      playing = !playing;
    };
    // Äáº£m báº£o nháº¡c tá»± play khi user tÆ°Æ¡ng tÃ¡c láº§n Ä‘áº§u (do trÃ¬nh duyá»‡t cháº·n autoplay)
    document.body.addEventListener('click', () => { music.play(); }, { once: true });
  </script>
</body>
</html>
